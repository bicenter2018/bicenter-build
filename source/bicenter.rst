.. _bicenter:

BICENTER 自由报表帮助手册
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
第1章	部署环境
-------------------
本章主要介绍BI-CENTER综合仪表板部署适用的软硬件环境。确保你拥有最低的硬件、软件配置。

*硬件服务器*
* 处理器：最低为Intel Pentium 或兼容133 MHz 的处理器。推荐Intel Xeon 2.4GHz双CPU多核或者更快的处理器。
* 内存：建议至少配置2G RAM；推荐4GB以上。
* 磁盘空间：200M以上空间。
* 显示器：VGA 或更高分辨率的监视器，最低分辨率1024*768。
性能会随着服务器配置（如CPU、内存等）的提高而有较大提升

:软件环境:
* 支持的操作系统：
	* Windows Server 2003 Enterprise以上
	* Enterprise Linux （core-3.0 以上）
:应用服务器：
	* Tomcat 6以上
	* JBOSS 4.2
	* Bea WebLogic 9.X
	* WebSphere 6.1
* 服务器Java版本：需要JDK1.5.06以上。
* 客户端浏览器：IE6 sp3以上，IE7，IE8，IE9。
* 数据库服务器：
	* Oracle 
	* MS SQL Server 
	* Teradata
	* DB2
	* Informix
	* Sybase
	* MySQL

第2章	表样定义四步骤
-------------------------
报表定义文件为二进制Excel文件，以xls或xlsx为后缀名。文件名不应包含中文字符。
在一个Excel报表表样定义里,**基本要求/查询定义/查询条件/define/其它设置/打印设置/chart /引用报表定义/存储定义**
其中**“基本要求”，“查询定义”，“查询条件”，“define”**标签页是必须存在的

2.1	报表文件标签页说明
~~~~~~~~~~~~~~~~~~~~~~~~~~~
报表文件标签页说明列表如下:

序号	标签页名称	填写说明	具体意义
====  =========    ========    =========
1	基本要求	必填	定义报表的基本属性（如温馨提示的内容），按模板填写
2	查询定义	必填	定义SQL查询
3	查询条件	必填	定义报表的查询参数及录入界面布局
4	define	必填	定义表样及填数规则
5	其它设置	选填	控制报表在界面显示效果和缓存等信息
6	打印设置	选填	定义打印（导出PDF）的缺省字体、纸张类型等
7	chart	选填	使用图表时定义
8	引用报表定义	选填	引用其他报表单元格时使用
9	存储定义	选填	有补录需求的报表，定义如何在数据库中存储补录数据
10	套表目录	选填	在做套表的时候需要用此页签代替define
11	校验规则	选填	和套表目录同时定义，配合使用
==  ========  ====    ==================================================
下面我们将逐一介绍标签页的具体用法

2.2	基本要求 
~~~~~~~~~~~~~~~~~~~~~~~~~~~
 .. image :: _static/images/bicenter/2.2.1.png 
在基本要求的标签页中，“业务说明”栏中有文字内容时，显示界面上的条件录入区左下角会出现信息图标，鼠标点击后，会显示该报表在基本要求标签页中“业务说明”中的内容。如某张报表的基本要求中业务说明如下:
 .. image :: _static/images/bicenter/2.2.2.png
界面上有一个感叹号的图标，鼠标悬浮其上查看报表的业务说明:
 .. image :: _static/images/bicenter/2.2.3.png

2.3	查询条件
~~~~~~~~~~~~~~~~~~~~~~~~~~~
一个查询条件标签页的基本格式如图：
 .. image :: _static/images/bicenter/2.3.1.png

2.3.1	界面布局
..................
 .. image :: _static/images/bicenter/2.3.1.1.png
“界面布局”用来指定用户在查看报表时页面上选择的查询条件。
“界面布局”合并单元格的个数必须大于等于下面显示的参数个数，如果合并的单元格个数小于参数个数，超出的参数在页面上显示无法控制。参数可以分行显现，从左至右依次自动排列。如下图。例：
 .. image :: _static/images/bicenter/2.3.1.2.png
界面效果：
 .. image :: _static/images/bicenter/2.3.1.3.png
 
2.3.2	条件名称
...................
页面布局和条件名称的参数名必须唯一对应。页面布局下的参数必须在报表条件名称下有定义，才能引用，否则读表样出错。条件名称的顺序没有严格要求。

2.3.3	用法
..................
用法有三种取值：查询条件、数据转换和录入校验。该列为选填项，可以直接删除或者不填，当它缺省时，默认表示该参数用法是查询条件。

2.3.3.1	单位转换
'''''''''''''''''''''''
用作数据转换的查询参数，仅用于实现数据转换，如单位转换，它们对应的报表都是同一份数据。如：某报表的数据在数据库中都是以元为单位，而用户希望同时看到以万元为单位的报表。这里，无论下拉框以元为单位，还是以万元为单位，我们对应的都是同一份以元为单位的数据，只是我们以万元为单位时，所有数据乘上了一个转换因子（对万元而言，我们乘了0.0001）。
在“取值范围”列，数据转换的转换因子，按“显示名（转换因子）”的语法定义。例：
 .. image :: _static/images/bicenter/2.3.3.1.1.png
单位转换可以和数据精度结合起来用，实现用单位控制小数位数。
 .. image :: _static/images/bicenter/2.3.1.1.2.png
在数据精度的默认值引用单位的变量名，接着单位的取值范围设置每个单元保留位数即可。如上图的：元(1.00)，代表选择元时，默认保留两位小数。

2.3.3.2	录入校验
'''''''''''''''''''''''''
用作录入校验时，可不填写变量名， 在“取值范围”列，需要填写录入有效性验证的布尔表达式，在“默认值”列填写有效性验证失败时的提示信息。
目前只支持calendar时间控件和text控件的录入校验。如图：
 .. image :: _static/images/bicenter/2.3.3.2.1.png
要实现录入校验，只需填四列，详情填法见下表：
序列	列名称	描述
====    ======  ========
1	条件名称	填写校验名称（不能重名）
2	用法	填写“录入校验”
3	默认值	填写验证失败时系统的提示信息
4	取值范围	填写用于录入校验规则的布尔表达式
==  ========    =======================================

:支持如下函数:
* ${DATEDIFF("day",var.day1,var.day)<100} ：表示以天为单位的变量 day1 与 day的差，变量day1和day应为Date 类型。
* !ISBLANK(var.hy)：变量hy是否为空。
* ${var.as-var.ss<20}：变量as和ss的差不能大于20。
上图在实际应用的实例：
不满足条件时，就会出现下图情况，红色字体即是在默认值中填写的内容
 .. image :: _static/images/bicenter/2.3.3.2.2.png
在所有条件满足时,才会执行查询。

2.3.4	变量名
..................
2.3.5	取值范围
..................
2.3.5.1	静态取值
'''''''''''''''''''''''''''''''''''
2.3.5.2	动态Java类调用取值
'''''''''''''''''''''''''''''''''''
2.3.5.3	select语句
'''''''''''''''''''''''''''''''''''
2.3.5.4	预定义层次维度
'''''''''''''''''''''''''''''''''''
2.3.5.5	预定义字典设置
'''''''''''''''''''''''''''''''''''
2.3.5.6	预定义分析工具维度层次
'''''''''''''''''''''''''''''''''''
2.3.6	依赖关系（级联菜单）
....................................
2.3.7	显示变量名
....................................
2.3.8	录入控件
....................................
2.3.8.1	文本框（text）
'''''''''''''''''''''''''''''''''''
2.3.8.2	下拉选择框（select）
'''''''''''''''''''''''''''''''''''
2.3.8.3	智能文本框（itext）
'''''''''''''''''''''''''''''''''''
2.3.8.4	日期选择（datepicker）
'''''''''''''''''''''''''''''''''''
2.3.8.5	日历选择（Calendar）
'''''''''''''''''''''''''''''''''''
2.3.8.6	多选下拉框（multiSelect）
'''''''''''''''''''''''''''''''''''
2.3.9	控件属性
....................................
2.3.10	只读
....................................
2.3.11	数据类型
....................................
2.3.12	默认值
....................................
2.3.12.1	日期选择控件的缺省值
'''''''''''''''''''''''''''''''''''
2.3.12.2	取Http Session或Http Request上下文中的参数值
'''''''''''''''''''''''''''''''''''
2.3.12.3	下拉选择框默认值
'''''''''''''''''''''''''''''''''''

2.3.13	数据格式
....................................
2.3.14	输入说明
....................................
2.4	查询定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
2.5	表样取数define
~~~~~~~~~~~~~~~~~~~~~~~~~~~
2.5.1	报表define基本结构
..............................
2.5.2	定义报表的过程
..............................
2.5.3	EEL语法
..............................
2.5.3.1	[ ]与. 运算符
'''''''''''''''''''''''''''''''''''''
2.5.3.2	变量引用
'''''''''''''''''''''''''''''''''''''
2.5.3.3	查询数据集中数据的引用
'''''''''''''''''''''''''''''''''''''
2.5.3.4	字典引用
'''''''''''''''''''''''''''''''''''''
2.5.3.5	混合运算
'''''''''''''''''''''''''''''''''''''
2.5.3.6	url请求参数引用
'''''''''''''''''''''''''''''''''''''
2.5.3.7	seesion参数引用
'''''''''''''''''''''''''''''''''''''
第3章	清单型报表定义的说明
---------------------------------
3.1	简单的清单报表
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.2	标注分组汇总
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.2.1	第一种 前端分组汇总
....................................
3.2.1.1	定义分组
'''''''''''''''''''''''''
3.2.1.2	批注
'''''''''''''''''''''''''''''''
3.2.1.3	分组聚合函数
'''''''''''''''''''''''''''''''
3.2.1.4	数据集聚合函数
'''''''''''''''''''''''''''''''
3.2.2	第二种 数据库分组汇总
....................................
3.2.2.1	定义分组
'''''''''''''''''''''''''''''''
3.2.2.2	批注
'''''''''''''''''''''''''''''''
3.3	清单型数据区定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.4	清单型报表同行excel运算
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.5	清单型报表交替背景色定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.5.1	填充色定义
............................
3.5.2	标注颜色值定义
............................
3.6	统计图定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.6.1	chart定义
............................
3.6.2	效果
............................
3.6.2.1	柱图实例
''''''''''''''''''''''''''''''''''''''
3.6.2.2	线图实例
''''''''''''''''''''''''''''''''''''''
3.6.2.3	散点图实例
''''''''''''''''''''''''''''''''''''''
3.6.2.4	饼图实例
''''''''''''''''''''''''''''''''''''''
3.6.2.5	条形图实例
''''''''''''''''''''''''''''''''''''''
3.7	嵌入多个单元格
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.8	清单合并单元格
~~~~~~~~~~~~~~~~~~~~~~~~~~~
3.9	清单型报表填充值设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~
第4章	特殊清单+自由布局报表（凭证）
-----------------------------------------
第5章	固定行列型报表定义的说明
---------------------------------------
5.1	固定型报表的数据区
~~~~~~~~~~~~~~~~~~~~~~~~~~~
5.2	固定型报表补录
~~~~~~~~~~~~~~~~~~~~~~~~~~~
5.2.1	标注补录区域
...................................
5.2.2	报表及补录数据存储定义
...................................
5.2.3	界面演示
...................................
5.3	固定型报表填充值设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~
第6章	套表定义
---------------------------
6.1	套表目录定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
6.2	平衡校验规则定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
第7章	特殊清单+固定行列型报表
----------------------------------
第8章	特殊效果
--------------------------
8.1	设置单元格格式
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.2	特殊人民币格式
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.2.1	人民币中文大写
...............................
8.2.2	人民币金额网格
...............................
8.3	斜线表头
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.4	隐藏指定列
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.5	标注多个章节
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.6	特殊格式及计算用法
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.6.1	表头的层次
...............................
8.6.2	单元格取多个查询结果计算
..................................
8.6.3	求和SUM
..................................
8.6.4	条件判断IF
..................................
8.7	标注Href跳转
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.8	标注列表头最小宽度
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.9	其它设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~
8.9.1	界面控制
...................
8.9.2	行为控制
...................
8.10	引用定义
~~~~~~~~~~~~~~~~~~~~~~~~~~~
第9章	打印控制
---------------------
9.1	打印设置标签页
~~~~~~~~~~~~~~~~~~~~~~~~~~~
9.2	打印列宽标注
~~~~~~~~~~~~~~~~~~~~~~~~~~~
9.3	各类报表套打标注
~~~~~~~~~~~~~~~~~~~~~~~~~~~
9.3.1	行列固定型报表的套打
................................
9.3.2	清单型报表的套打
................................
9.3.3	混合型报表的套打
................................

第10章	系统重要设置
--------------------------
10.1	数据源设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.2	表样存放地址/缓存存放地址设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.2.1	表样存放路径
...........................
10.2.2	缓存存放路径
...........................
10.2.3	表样打包说明
...........................
10.2.4	多配置方法
.............................
10.3	数据更新时间获取方法设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.4	日志记录方案设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.5	预定义字典设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.6	预定义系统变量设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.7	当前用户信息获取方法设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.8	配置使用LOG4J记录日志
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.9	统计图序列颜色设置
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.10	Tomcat安装及访问路径
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
10.11	集成报表URL引用
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
第11章	授权
--------------------
11.1	试用版本
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
11.2	正式版本
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
11.3	作为jar包，内嵌入其它应用
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
11.4	公司内部申请正式lisence
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
第12章	常见问题及使用技巧
---------------------------
